<?php include("../config.php");function getIpAddr(){    if (!empty($_SERVER['HTTP_CLIENT_IP'])){        $ip=$_SERVER['HTTP_CLIENT_IP'];    }    // Check if the IP is passed from a proxy.    elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){        $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];    }/* ??????? Why when I delet this line will cause a problem ?????*/
    else{        $ip=$_SERVER['REMOTE_ADDR'];    }    return $ip;}$ip = getIpAddr();if(isset($_COOKIE['searchID2']) or isset($_REQUEST['searchID2'])){	if(isset($_COOKIE['searchID2'])) {$searchID2=(int)$_COOKIE['searchID2'];}	ELSEIF(isset($_REQUEST['searchID2'])){$searchID2=(int)$_REQUEST['searchID2'];}	$GetDisplay = "SELECT *	FROM main WHERE id = $searchID2 ORDER BY id LIMIT 1";	include("../RecordSet.php");	setcookie("searchID2","",time() + 3600); }ELSEIF(isset($_POST['searchID'])){	$searchID2 = (int)$_POST['searchID'];	$GetDisplay = "SELECT * FROM main WHERE id = $searchID2 ORDER BY id  LIMIT 1";	include("../RecordSet.php");}ELSEIF(isset($_POST['comments'])){		$todaydate = date("l, F j, Y, g:i a");		$to = 'raymondlwhuang@yahoo.com';		$cc = "raymondlwhuang@gmail.com";        $subject = "Comments";        $email = $_REQUEST['sender_email'] ;        $message = $_REQUEST['message'];        if (preg_match("/bcc:/i", $email . " " . $message) == 0 &&          /* check for injected 'bcc' field */            preg_match("/Content-Type:/i", $email . " " . $message) == 0 && /* check for injected 'content-type' field */            preg_match("/cc:/i", $email . " " . $message) == 0 &&           /* check for injected 'cc' field */            preg_match("/to:/i", $email . " " . $message) == 0) {           /* check for injected 'to' field */            // Format the body of the email            $message = "Email: $email\n" . $message . "\n\nSent from: $ip ($todaydate)\n";            // Set the header, include the ip and set the reply-to field for convenience when replying to the email            $headers = "CC: $cc\nX-Sender-IP: $ip\nFrom: $email\nReply-To: $email";            // Send the email and check the result whether the function call was successful or not            $sent = mail($to, $subject, $message, $headers) ;            if($sent) {                echo '<script type="text/javascript">alert("Your mail was sent successfully")</script>';            } else {                echo '<script type="text/javascript">alert("We encountered an error sending your mail")</script>';            }        } else  {            echo '<script type="text/javascript">alert("We encountered an error sending your mail")</script>';/*????????????????? Why this line can't delete ????????????????*/
        }}?><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html class="cufon-active cufon-ready"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>My Blog</title><script type="text/javascript" src="../scripts/fancydropdown.js"></script><script type="text/javascript" src="../scripts/jquery.cycle.all.min.js"></script><script type="text/javascript">$(document).ready(function() {	$('#slider-container').cycle({        fx:     'uncover',        speed:  1000,        timeout: 7000,		pause:	1,        pager:  '#banner-nav'	});});</script><script src="http://html5media.googlecode.com/svn/trunk/src/jquery.html5media.min.js"></script><link type="text/css" rel="stylesheet" href="../css/MyResource.css" /><script type="text/javascript" src="../scripts/passVarToPhp.js"></script><script language="JavaScript" src="http://j.maxmind.com/app/geoip.js"></script><script type="text/javascript">	function validEMail(email) {		var re = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;		if (!re.test(email)){			alert("Invalid e-mail address!");		}		return re.test(email);				}	</script><script type="text/javascript" src="../scripts/VideoSelect.js"></script><style type="text/css" media="screen">.pictures{ background:url(../images/information.jpg); vertical-align: top;}.information{ background:url(../images/map.png) no-repeat;  text-align:center; color:blue;}</style></head><body><table width="100%" border="1"  bordercolor="blue"><tr>	<td valign="top" colspan="2">		<iframe src="VideoMain.php" width="590" height="265" style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;margin-top:0px;">		  <p>Your browser does not support iframes.</p>		</iframe>		</td>	<td class="pictures" align="center">		<?php		$dirPath = "../pictures/";		function traverseDir( $dir ) {		$countimg = 0;		  if ( !( $handle = opendir( $dir ) ) ) die( "Cannot open $dir." );		  $files = array();		  while ( $file = readdir( $handle ) ) {			if ( $file != "." && $file != ".." ) {			  if ( is_dir( $dir . "/" . $file ) ) $file .= "/";			  $files[] = $file;			}		  }		  sort( $files );		echo '<div style="overflow: hidden;" id="slider-container">';		  foreach ( $files as $file ) {		  $countimg++;		  $content ='<div style="display: none; opacity: 1;height: 275px;" id="banner'."$countimg".'">';		  $content = "$content"."<img src='../pictures/$file' height='100%' alt='Register' usemap='#mail-info' border='0'>";		  $content = "$content".'</div>';		  echo "$content";			  foreach ( $files as $file ) {				if ( substr( $file, -1 )  == "/" ) traverseDir( "$dir/" . substr( $file, 0, -1 ) );			  }		  };		  closedir( $handle );		echo '</div>';		}		traverseDir( $dirPath );		?>		</td>	<td align="right">		<form method='post' enctype='multipart/form-data'>		    Video supported are (Ogg,mp4,WebM)<br/>			Select video or picture to upload:<br/>			<input type='file' name='filename' size='10' />			<input type='submit' value='Upload' />		</form>		<?php 		if ($_FILES)		{			$name = $_FILES['filename']['name'];			$ext = substr($name,strpos($name,".") + 1);			if ($ext == 'gif') $n = "../pdf/".$name;			else if ($ext == 'gif' 				  || $ext == 'png'				  || $ext == 'jpg'				  || $ext == 'tif'				  ) $n = "../pictures/".$name;			else if ($ext == 'mp4') $n = "../videos/".$name;			else $n = '';			if ($n != ''){				if(!move_uploaded_file($_FILES['filename']['tmp_name'], $n))				echo  "Upload failed!";				else echo  "Uploaded file '$name' as '$n':<br />";			}		}		else echo "No file has been uploaded";		echo '<br/><font color="red">It will see by everyone come to this site after upload</font>';		echo "</body></html>";?>		</td></tr><tr>	<td class="information">	    <font color="red"><b>Some information that I get from you:</b></font><br/>		<?php 			if ($ip != '') echo "Your IP Address is: ".$ip; 			else "Can't figure out your IP address!";		?>		<br/>		You live in <script language="JavaScript">document.write(geoip_city());</script> city of 		<script language="JavaScript">document.write(geoip_region_name());</script> ,		<script language="JavaScript">document.write(geoip_country_name());</script>		<br/>		<script language="JavaScript">		if(geoip_postal_code() != ''){		document.write('Your Postal/Zip Code is:' + geoip_postal_code());		}		else document.write("I am sorry Can't figure out your Postal/Zip Code!");		</script>			<br>		Your current Latitude: <script language="JavaScript">document.write(geoip_latitude());</script>		<br/> 		Your current Longitude <script language="JavaScript">document.write(geoip_longitude());</script>		<br/>		I will figure out your name next time!	</td>	<td colspan="2">		<form name="comments" method="POST">			Please submit any comments <input type="submit" name="comments" value="submit" onClick="return validEMail(document.getElementById('email').value);">			Your email address:<input type="text" size="70" name="sender_email" id="email" value="" style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;"><br/>			<textarea name="message" id="message" rows="12" cols="100" style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;"></textarea>		</form>			</td>	<td align="center">	<font size="6" color="red"><b>What should I put here?</b></font>	<img src="../images/Question.jpg" alt="What should I put here?" />	</td></tr><tr>	<td valign="top">		<iframe src="http://raymondlwhuang.host56.com/MyHelpFile.php" width="420" height="370">		  <p>Your browser does not support iframes.</p>		</iframe>		</td>	<td valign="top" colspan="2">		<form name="DescSearch" method="POST">		<input type="hidden" name="searchID" id="searchID" />		<div align="left">		  <table border="0" id="help">			<tr>			<td rowspan="2">			<img src="../images/help.jpg">			</td>			<td align="right">			<font color="red" size="6">Need some tips?<br/></font><font color="red">search here</font>			<input type="text"  id="searchField" autocomplete="off" name="ShortDesc" size="70"  maxlength="200" id="ShortDesc"  style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;" onFocus = "clearChoice();" onKeyUp="SendRequest('../SearchShortDesc.php',document.getElementById('SearchGroup').value);"/>			</td>			</tr>			<tr>			<td align="left" colspan="2"><div id="popups"> </div></td>			</tr>		  </table>		  </div>		</form>			<form action="<?php echo $_SERVER['SCRIPT_NAME']; ?>" name="MyForm" enctype="application/x-www-form-urlencoded" method="post">		<table width="100%">		  <tr>			<td colspan="6"></td>		  </tr>		  <tr>			<td><p></p></td>			<td colspan="5"><input type="text" name="ShortDesc" size="100" maxlength="200" style="font-weight:bold;border: 0px #38c;position : relative; top:0em;left: 2em ;text-align:left"  value="<?php if (isset($ShortDesc)){ echo htmlspecialchars($ShortDesc); } else ''; ?>" readonly="readonly"></td>			</tr>			<tr>			<td colspan="6">			<div class="container">			<textarea name="Source" id="Source" rows="8" cols="100" style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;" readonly="readonly"><?php if (isset($Source)){ echo trim(htmlspecialchars($Source)); } else ''; ?></textarea>			</div>			</td>			   </tr>		  <tr>			<td>			<select name="SearchGroup" id="SearchGroup" class="reqd" style="visibility:hidden;">			   <option value="" <?php if(isset($SearchGroup) && htmlspecialchars($SearchGroup) == "") echo "selected"; ?>>ALL</option>			 </select>					</td>			<td align="right"><p></p></td>			<td width="20"><input type="hidden" name="Name" id="Name" size="15" maxlength="50" style="border: 1px solid #38c;"  value="<?php if (isset($Name)){ echo htmlspecialchars($Name); } else ''; ?>"></td>			<td align="left" width="10"><p></p></td>			<td align="left" width="20">				<input type="hidden" name="Ext" id = "Ext" size="100" maxlength="200" style="border: 1px solid #38c;"  value="<?php if (isset($Ext)){ echo htmlspecialchars($Ext); } else ''; ?>">			</td>			<td align="left" width="15"><p></p></td>		</tr>  		</table>    		</form>		</td>	<td valign="top" >		<iframe src="../HTML/Resume.htm" id="loaddisp" width="98%" height="370px" style="border-color:#ff0000 #0000ff;border-style:ridge; border-width: 3px;margin-top:0px;">		  <p>Your browser does not support iframes.</p>		</iframe>		</td></tr></table></body></html><script type="text/javascript">	var text = document.getElementById('Ext').value;	if(text == "php") var value = document.getElementById("Name").value+'.'+text;	else if(text == "pdf") var value = "../pdf/"+document.getElementById("Name").value+'.'+text;	else var value = "../HTML/"+document.getElementById("Name").value+'.'+text;	if(text == "php" || text == "html" || text == "pdf") document.getElementById('loaddisp').src = value;	else if(text == "link") window.open(document.getElementById("Source").innerHTML);</script>